VIDEO_VIEWABILITY_OUTER_COLUMNS() ::= <<
    FORMAT(100*VVIC.inView1qPct*VVIC.scaleFactor, 2) as inView1qPct,
    FORMAT(100*VVIC.completed1qPct*VVIC.scaleFactor, 2) as completed1qPct,
    FORMAT(100*VVIC.inView2qPct*VVIC.scaleFactor, 2) as inView2qPct,
    FORMAT(100*VVIC.completed2qPct*VVIC.scaleFactor, 2) as completed2qPct,
    FORMAT(100*VVIC.inView3qPct*VVIC.scaleFactor, 2) as inView3qPct,
    FORMAT(100*VVIC.completed3qPct*VVIC.scaleFactor, 2) as completed3qPct,
    FORMAT(100*VVIC.inView4qPct*VVIC.scaleFactor, 2) as inView4qPct,
    FORMAT(100*VVIC.completed4qPct*VVIC.scaleFactor, 2) as completed4qPct,
    FORMAT(100*VVIC.inView4qPct100*VVIC.scaleFactor, 2) as inView4qPct100,
    FORMAT(100*VVIC.inView2qPct100*VVIC.scaleFactor, 2) as inView2qPct100,
    FORMAT(100*VVIC.neverStartedPct*VVIC.scaleFactor, 2) as neverStartedPct,
    FORMAT(100*VVIC.inViewPct*VVIC.scaleFactor, 2) as inViewPct,
    FORMAT(100*VVIC.outOfViewPct*VVIC.scaleFactor, 2) as outOfViewPct,
    FORMAT(100*VVIC.inViewPct100*VVIC.scaleFactor, 2) as inViewPct100,
    FORMAT(100*VVIC.mutedPct*VVIC.scaleFactor, 2) as mutedPct,
    FORMAT(100*VVIC.fullScreenPct*VVIC.scaleFactor, 2) as fullScreenPct,
    FORMAT(100*VVIC.clickThroughRate*VVIC.scaleFactor, 2) as clickThroughRate,
    VVIC.suspiciousPct,
    VVIC.suspiciousImps,
    VVIC.measuredImps,
    VVIC.totalVideoImpressions,
    VVIC.totalImpressions
>>

VIDEO_VIEWABILITY_INNER_COLUMNS() ::= <<
    FORMAT(SUM((IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS)*IN_VIEW_1Q_PCT)/SUM(IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS), 2) as inView1qPct,
    FORMAT(SUM((IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS)*COMPLETED_1Q_PCT)/SUM(IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS), 2) as completed1qPct,
    FORMAT(SUM((IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS)*IN_VIEW_2Q_PCT)/SUM(IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS), 2) as inView2qPct,
    FORMAT(SUM((IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS)*COMPLETED_2Q_PCT)/SUM(IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS), 2) as completed2qPct,
    FORMAT(SUM((IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS)*IN_VIEW_3Q_PCT)/SUM(IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS), 2) as inView3qPct,
    FORMAT(SUM((IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS)*COMPLETED_3Q_PCT)/SUM(IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS), 2) as completed3qPct,
    FORMAT(SUM((IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS)*IN_VIEW_4Q_PCT)/SUM(IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS), 2) as inView4qPct,
    FORMAT(100*(SUM(FULLY_IN_VIEW_AT_COMPLETION)/SUM(IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS)), 2) as inView4qPct100,
    FORMAT(SUM((IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS)*COMPLETED_4Q_PCT)/SUM(IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS), 2) as completed4qPct,
    FORMAT(SUM((IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS)*FULLY_IN_VIEW_2Q_PCT)/SUM(IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS), 2) as inView2qPct100,
    FORMAT(SUM((IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS)*NEVER_STARTED_PCT)/SUM(IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS), 2) as neverStartedPct,
    FORMAT(SUM((IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS)*IN_VIEW_PCT)/SUM(IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS), 2) as inViewPct,
    FORMAT(SUM((IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS)*NOT_IN_VIEW_PCT)/SUM(IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS), 2) as outOfViewPct,
    FORMAT(SUM((IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS)*FULLY_IN_VIEW_1S_PCT)/SUM(IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS), 2) as inViewPct100,
    FORMAT(SUM((IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS)*MUTED_PCT)/SUM(IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS), 2) as mutedPct,
    FORMAT(SUM((IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS)*FULL_SCREEN_PCT)/SUM(IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS), 2) as fullScreenPct,
    FORMAT(SUM((IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS)*CLICK_THROUGH_PCT)/SUM(IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS), 2) as clickThroughRate,
    100*SUM(SUSPICIOUS_IMPS)/SUM(IMPS) as suspiciousPct,
    SUM(SUSPICIOUS_IMPS) as suspiciousImps,
    ROUND(SUM(IF(Q_DATA_IMPS > IMPS, ((IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS)/(Q_DATA_IMPS/IMPS)), IN_VIEW_IMPS+NOT_IN_VIEW_IMPS+SUSPICIOUS_IMPS))) as measuredImps,
    SUM(IF($MEDIA_TYPE_VIDEO_FILTER()$, IMPS, 0)) as totalVideoImpressions,
    SUM(IMPS) as totalImpressions,
    (
        $VIEWABILITY_SCALE_FACTOR()$
    ) as scaleFactor
>>
